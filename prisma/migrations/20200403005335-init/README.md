# Migration `20200403005335-init`

This migration has been generated by Michael Khait at 4/3/2020, 12:53:35 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "blog"."User" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "email" text  NOT NULL ,
    "firstname" text   ,
    "id" text  NOT NULL ,
    "lastname" text   ,
    "password" text  NOT NULL ,
    "role" "Role" NOT NULL DEFAULT 'USER',
    "updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "blog"."Profile" (
    "bio" text  NOT NULL ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "id" text  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL ,
    "userId" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "blog"."Post" (
    "authorId" text  NOT NULL ,
    "content" text   ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "id" text  NOT NULL ,
    "published" boolean  NOT NULL DEFAULT false,
    "title" text  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "blog"."Category" (
    "id" text  NOT NULL ,
    "name" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "blog"."_CategoryToPost" (
    "A" text  NOT NULL ,
    "B" text  NOT NULL 
) 

CREATE UNIQUE INDEX "User.email" ON "blog"."User"("email")

CREATE UNIQUE INDEX "Profile_userId" ON "blog"."Profile"("userId")

CREATE UNIQUE INDEX "_CategoryToPost_AB_unique" ON "blog"."_CategoryToPost"("A","B")

CREATE  INDEX "_CategoryToPost_B_index" ON "blog"."_CategoryToPost"("B")

ALTER TABLE "blog"."Profile" ADD FOREIGN KEY ("userId")REFERENCES "blog"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "blog"."Post" ADD FOREIGN KEY ("authorId")REFERENCES "blog"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "blog"."_CategoryToPost" ADD FOREIGN KEY ("A")REFERENCES "blog"."Category"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "blog"."_CategoryToPost" ADD FOREIGN KEY ("B")REFERENCES "blog"."Post"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200403005335-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,53 @@
+datasource db {
+  provider = "postgresql"
+  url      = env("POSTGRESQL_URL")
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  email     String   @unique
+  password  String
+  firstname String?
+  lastname  String?
+  role      Role     @default(USER)
+  posts     Post[]
+  profile   Profile?
+}
+
+model Profile {
+  id        String     @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  bio       String
+  user      User    @relation(fields: [userId], references: [id])
+  userId    String
+}
+
+model Post {
+  id         String         @id @default(cuid())
+  createdAt  DateTime @default(now())
+  updatedAt  DateTime @updatedAt
+  title      String
+  published  Boolean     @default(false)
+  author     User        @relation(fields: [authorId], references: [id])
+  authorId   String
+  content    String?
+  categories Category[]  @relation(references: [id])
+}
+
+model Category {
+  id    String     @id @default(cuid())
+  name  String
+  posts Post[]  @relation(references: [id])
+}
+
+enum Role {
+  USER
+  ADMIN
+}
```


